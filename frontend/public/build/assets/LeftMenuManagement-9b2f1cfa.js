import{r as n,u as z,j as e,b as W}from"./app-6ded1f35.js";import{P as q}from"./PageNav-e43fddb7.js";import{A as H}from"./AuthenticatedLayout-c783bf9c.js";import{T as E,C as V}from"./CheckCircleIcon-6edce93d.js";import{C as S,a as G}from"./ChevronUpIcon-20eadce7.js";import"./Brand-d3ec3ec6.js";function J({title:a,titleId:c,...x},h){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:h,"aria-labelledby":c},x),a?n.createElement("title",{id:c},a):null,n.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const K=n.forwardRef(J),Q=K;function X({title:a,titleId:c,...x},h){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:h,"aria-labelledby":c},x),a?n.createElement("title",{id:c},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 019 9v.375M10.125 2.25A3.375 3.375 0 0113.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 013.375 3.375M9 15l2.25 2.25L15 12"}))}const Y=n.forwardRef(X),Z=Y;function _({title:a,titleId:c,...x},h){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:h,"aria-labelledby":c},x),a?n.createElement("title",{id:c},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))}const ee=n.forwardRef(_),te=ee;function se({title:a,titleId:c,...x},h){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:h,"aria-labelledby":c},x),a?n.createElement("title",{id:c},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"}))}const ne=n.forwardRef(se),le=ne;function ae({linkName:a,linkURL:c,callUpdateLink:x}){const[h,y]=n.useState(a),[o,b]=n.useState(c);return e.jsxs("li",{className:"flex flex-cols-2 gap-2 w-full",children:[e.jsx("input",{type:"text",defaultValue:h,onChange:p=>y(p.target.value),onBlur:()=>{let p={};p[h]=o,x(p)},className:"input input-bordered w-1/3"}),e.jsx("input",{type:"text",defaultValue:o,onChange:p=>b(p.target.value),onBlur:()=>{let p={};p[h]=o,x(p)},className:"input input-bordered w-2/3"})]})}function re({category:a,deleteLink:c,addLink:x,moveLinkUp:h,moveLinkDown:y,updateLink:o}){const[b,p]=n.useState({"":""}),[k,C]=n.useState(""),[D,L]=n.useState(""),j=n.useRef(null),N=n.useRef(null);function v(r){var m;p(r),(m=j.current)==null||m.showModal()}function g({linkPair:r,index:m,keyString:w}){function R(M){o(a,m,M)}return e.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[e.jsx(ae,{linkName:w,linkURL:r[w],callUpdateLink:R}),e.jsx(E,{className:"w-4 cursor-pointer",onClick:()=>v(r)}),e.jsx(G,{className:"w-5 cursor-pointer",onClick:()=>h(a,m)}),e.jsx(S,{className:"w-5 cursor-pointer",onClick:()=>y(a,m)})]})}return e.jsxs("details",{open:!0,children:[e.jsxs("summary",{draggable:!0,className:"flex flex-cols-3 justify-between text-base-100 font-bold bg-neutral p-4 rounded-br-lg rounded-tr-lg",children:[e.jsx("div",{}),a.name,e.jsx(S,{className:"w-4 cursor-pointer"})]}),e.jsxs("ul",{className:"card p-4 gap-y-2 rounded-bl-none",children:[e.jsxs("div",{className:"flex flex-cols-2 font-bold gap-2 pr-6",children:[e.jsx("h3",{className:"w-1/3",children:"Title"}),e.jsx("h3",{className:"w-2/3",children:"URL"})]}),a.links.map((r,m)=>{const w=Object.keys(r)[0];return e.jsx(g,{linkPair:r,index:m,keyString:w},r[w].concat(m.toString()))}),e.jsx("button",{className:`btn btn-active
                    bg-base-200 w-full p-2`,onClick:()=>{var r;return(r=N.current)==null?void 0:r.showModal()},children:e.jsx(Q,{className:"w-6 mx-auto"})})]}),e.jsx("dialog",{ref:j,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"✕"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Delete Link"}),e.jsx("p",{className:"py-4",children:"Are you sure you would like to delete this link?"}),e.jsxs("form",{method:"dialog",className:"flex flex-row justify-between",children:[e.jsx("button",{className:"btn",children:"Cancel"}),e.jsx("button",{className:"btn btn-error",onClick:()=>c(a,b),children:"Delete Link"})]})]})}),e.jsx("dialog",{ref:N,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"✕"})}),e.jsx("form",{method:"dialog",onSubmit:()=>{x(a,k,D),C(""),L("")},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl font-semibold pb-6 text-neutral",children:"Add Link"}),e.jsxs("label",{className:"form-control w-full",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Title"})}),e.jsx("input",{type:"text",placeholder:"Type here",className:"input input-bordered w-full",value:k,onChange:r=>C(r.target.value),required:!0})]}),e.jsxs("label",{className:"form-control w-full",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL"})}),e.jsx("input",{type:"url",placeholder:"Type here",className:"input input-bordered w-full",value:D,onChange:r=>L(r.target.value),required:!0})]}),e.jsx("label",{className:"form-control pt-6",children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Add"})})]})})]})})]})}function he({auth:a}){const{data:c,error:x,mutate:h,isLoading:y}=z("/api/v1/categories"),[o,b]=n.useState(Array),[p,k]=n.useState(""),[C,D]=n.useState(null),L=n.useRef(null),j=n.useRef(null),N=n.useRef(null),v=n.useRef(null),g=n.useRef(null),[r,m]=n.useState(null);n.useEffect(()=>{c!=null&&b(c.data)},[c]);const w=n.useMemo(()=>x?e.jsx("div",{children:"failed to load"}):y?e.jsx("div",{children:"loading..."}):o.map((t,l)=>e.jsxs("div",{children:[e.jsx("div",{className:g.current==l?r==-1?"block grow":"hidden":"block grow",children:e.jsxs("div",{className:r==l?"pt-36 flex":"pt-6 flex",onDragOver:s=>{s.preventDefault(),m(l)},onDragLeave:s=>{s.preventDefault(),m(null)},onDrop:s=>{s.preventDefault(),g.current==null},onDragStart:()=>g.current=l,onDragEnd:s=>{s.preventDefault(),r==null?m(-1):F()},children:[e.jsx("div",{className:"bg-neutral rounded-bl-lg rounded-tl-lg pl-3 h-15",children:e.jsx(E,{className:"w-4 mt-5 self-start text-base-100 cursor-pointer",onClick:()=>{var s;(s=j.current)==null||s.showModal(),D(t.id)}})}),e.jsx("div",{className:"grow",children:e.jsx(re,{category:t,deleteLink:O,addLink:I,moveLinkUp:U,moveLinkDown:$,updateLink:B})})]})}),l==o.length-1?e.jsx("div",{className:"h-screen",onDragOver:s=>{s.preventDefault(),m(l+1)},onDragLeave:s=>{s.preventDefault(),m(null)},onDrop:s=>{s.preventDefault(),g.current==null}}):null]},t.name.concat(t.id.toString()))),[o,r]);function R(){const t={id:Math.random(),name:p,links:[],rank:o.length+1};b([...o,t]),k("")}function M(t){const l=o.filter(s=>s.id!==t);b(l)}function A(){var t;C!=null&&M(C),(t=j.current)==null||t.close()}function I(t,l,s){let d={};d[l]=s;const u=o.map((f,i)=>(f==t&&f.links.push(d),f));b(u)}function O(t,l){const s=o.map((d,u)=>(d==t&&(d.links=d.links.filter(f=>f!==l)),d));b(s)}function U(t,l){if(l==0)return;const s=l-1,d=o.map((u,f)=>{if(u==t){const i=u.links,T=i[s];return i[s]=i[l],i[l]=T,u.links=i,u}else return u});b(d)}function $(t,l){if(l==t.links.length-1)return;const s=l+1,d=o.map((u,f)=>{if(u==t){const i=u.links,T=i[s];return i[s]=i[l],i[l]=T,u.links=i,u}else return u});b(d)}function B(t,l,s){o.map((d,u)=>(d==t&&(t.links[l]=s),d))}function F(){if(g.current==null||r==null)return;let t=r;g.current<r&&(t=t-1);let l=[...o];const s=l.splice(g.current,1)[0];t==o.length?l.push(s):l.splice(t,0,s),b(l),g.current=null,m(null)}async function P(t){var s,d,u;t.preventDefault();const l=o.map((f,i)=>(f.rank=i+1,f));try{(await W("/api/v1/categories",{method:"PUT",headers:{ContentType:"application/json"},data:l})).status!==200?((s=v.current)==null||s.classList.add("opacity-100"),setTimeout(()=>{var i;(i=v.current)==null||i.classList.remove("opacity-100")},5e3)):(h(),(d=N.current)==null||d.classList.add("opacity-100"),setTimeout(()=>{var i;(i=N.current)==null||i.classList.remove("opacity-100")},5e3))}catch{(u=v.current)==null||u.classList.add("opacity-100"),setTimeout(()=>{var f;(f=v.current)==null||f.classList.remove("opacity-100")},5e3)}}return e.jsxs(H,{user:a.user,title:"Categories",children:[e.jsx(q,{user:a.user,path:["Settings","Left Menu Management"]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>{var t;return(t=L.current)==null?void 0:t.showModal()},children:[e.jsx(le,{className:"h-4 text-base-100"}),e.jsx("span",{className:"text-base-100",children:"Add Category"})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:t=>P(t),children:e.jsx(Z,{className:"h-4 text-base-100"})})]}),e.jsx("div",{children:w})]}),e.jsx("dialog",{ref:j,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick:()=>{var t;return(t=j.current)==null?void 0:t.close()},children:"✕"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Delete Category"}),e.jsxs("p",{className:"py-4",children:["Are you sure you would like to delete this category?",e.jsx("br",{})," Deleting this category will delete all links associated with it."]}),e.jsxs("form",{method:"dialog",className:"flex flex-row justify-between",children:[e.jsx("button",{className:"btn",onClick:()=>{var t;return(t=j.current)==null?void 0:t.close()},children:"Cancel"}),e.jsx("button",{className:"btn btn-error",type:"button",onClick:()=>A(),children:"Delete Category"})]})]})}),e.jsx("dialog",{ref:L,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",children:"✕"})}),e.jsx("form",{method:"dialog",onSubmit:R,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-3xl font-semibold pb-6 text-neutral",children:"Add Category"}),e.jsxs("label",{className:"form-control w-full",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Title"})}),e.jsx("input",{type:"text",placeholder:"Type here",className:"input input-bordered w-full",value:p,onChange:t=>k(t.target.value),required:!0})]}),e.jsx("label",{className:"form-control pt-6",children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Add"})})]})})]})}),e.jsx("div",{ref:N,className:"toast transition-opacity duration-500 ease-out opacity-0",children:e.jsxs("div",{className:"alert alert-success",children:[e.jsx(V,{className:"h-6"}),e.jsx("span",{children:"Categories saved!"})]})}),e.jsx("div",{ref:v,className:"toast transition-opacity duration-500 ease-out opacity-0",children:e.jsxs("div",{className:"alert alert-error text-neutral",children:[e.jsx(te,{className:"h-6"}),e.jsx("span",{children:"Error saving categories"})]})})]})}export{he as default};
